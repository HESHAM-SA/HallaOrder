{% extends "home/base.html" %}

{% load static %}


{% block style %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
{% endblock style %}

{% block content %}
<style>
    #dashbaord {
        display: none;
    }

    .color-swatch {
        width: 42px;
        height: 42px;
        border-radius: .5rem;
        border: 1px solid rgba(0, 0, 0, .1)
    }

    .logo-preview {
        width: 100%;
        max-width: 160px;
        aspect-ratio: 1/1;
        object-fit: contain;
        border: 1px dashed #ccc;
        border-radius: 1rem;
        padding: .5rem;
        background: #fff
    }
</style>

{% include "home/header_platform.html" %}




<div class="w-100">
    {% if messages %}
    <ul>
        {% for message in messages %}
        <div class="alert {{message.tags}}">
            <i class="fa-solid fa-circle-exclamation"></i>
            <span>{{message}}</span>
        </div>
        {% endfor %}
    </ul>
    {% endif %}
</div>

<div class="row w-100 p-4">
    <div class="col-md-6 p-4">
        <div class="card">
            <h1>انشاء هوية المطعم</h1>
            <div class="card-body">
                <form action="" method="post" enctype="multipart/form-data" class="row g-3">
                    {% csrf_token %}

                    <!-- اسم المطعم -->
                    <div class="col-12">
                        <label for="restaurant_name" class="form-label">اسم المطعم</label>
                        <input type="text" class="form-control" id="restaurant_name" name="restaurant_name" required
                            maxlength="120" placeholder="مثال: مطعم البيت العربي">
                    </div>

                    <!-- وصف المطعم -->
                    <div class="col-12">
                        <label for="restaurant_desc" class="form-label">وصف المطعم</label>
                        <textarea class="form-control" id="restaurant_desc" name="restaurant_desc" rows="4"
                            placeholder="اكتب نبذة قصيرة عن المطعم وقائمة الأطباق المميزة"></textarea>
                    </div>
                    <!-- شعار المطعم -->
                    <div class="col-6 text-center">
                        <label for="restaurant_logo" class="form-label">شعار المطعم</label>
                        <div class="border border-2 border-dashed p-5 rounded position-relative mx-auto"
                            style="max-width: 300px; cursor:pointer;">
                            <i class="fas fa-utensils fa-3x text-secondary mb-3"></i>
                            <p class="mb-0 text-muted">اختر صورة الشعار</p>
                            <input type="file"
                                class="form-control position-absolute top-0 start-0 w-100 h-100 opacity-0"
                                id="restaurant_logo" name="restaurant_logo"
                                accept="image/png, image/jpeg, image/webp, image/svg+xml">
                        </div>
                        <div class="form-text">أنواع مقبولة: PNG, JPG, WEBP, SVG</div>
                    </div>
                    <div class="col-6 d-flex align-items-center" style="justify-content: center;">
                        <img id="logoPreview" class="logo-preview" alt="معاينة الشعار">
                    </div>

                    <hr class="mt-4" />

                    <!-- Primary Color -->
                    <div class="col-md-6">
                        <label for="primary_color" class="form-label">اللون الأساسي</label>
                        <div class="input-group">
                            <input type="color" class="form-control form-control-color" id="primary_color_picker"
                                value="#FFAF00">
                            <input type="text" class="form-control" id="primary_color_text" name="primary_color"
                                placeholder="#HEX" value="#FFAF00" required>
                        </div>
                        <div class="form-text">اكتب 6 خانات هكس بدون # (مثال: 007090)</div>
                    </div>

                    <!-- Secondary Color -->
                    <div class="col-md-6">
                        <label for="secondary_color" class="form-label">اللون الجانبي (اختياري)</label>
                        <div class="input-group">
                            <input type="color" class="form-control form-control-color" id="secondary_color_picker"
                                value="#007090">
                            <input type="text" class="form-control" id="secondary_color_text" name="secondary_color"
                                placeholder="#HEX" value="#007090">
                        </div>
                    </div>

                    <div class="col-12 d-flex gap-2">
                        <button type="submit" class="btn btn-blue">حفظ</button>
                        <button type="reset" class="btn btn-orange">تفريغ الحقول</button>
                        <a href="" class="btn btn-dark">رجوع</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="col-md-6 p-4">
        <div class="svg-container text-center my-4">
            <svg id="restaurantSVG" xmlns="http://www.w3.org/2000/svg" width="70%" viewBox="0 0 800.003 618.867"
                xmlns:xlink="http://www.w3.org/1999/xlink" role="img" artist="Katerina Limpitsouni"
                source="https://undraw.co/">
                <g transform="translate(-560 -231)">
                    <path
                        d="M15.18,488.765a1.456,1.456,0,0,0,1.308,1.575H668.472a1.6,1.6,0,0,0,0-3.15H16.488a1.456,1.456,0,0,0-1.308,1.575Z"
                        transform="translate(621.678 359.527)" fill="#d6d6e3" />
                    <path d="M353.105,370.945a27.478,27.478,0,0,1-54.387,0H229.146V524.776H422.677V370.945H353.105Z"
                        transform="translate(634.09 321.941)" fill="#d6d6e3" />
                    <path
                        d="M789.214,487.736H10.789A10.8,10.8,0,0,1,0,476.947V32.7A10.8,10.8,0,0,1,10.789,21.911H789.214A10.8,10.8,0,0,1,800,32.7V476.947a10.8,10.8,0,0,1-10.789,10.789Z"
                        transform="translate(560 209.089)" fill="#090814" />
                    <rect width="761.747" height="429.819" transform="translate(580.088 249.003)" fill="#fff" />
                    <rect class="color_var" width="108" height="360" rx="4" transform="translate(609 273)" fill="#FFAF00" />
                    <path d="M6,0H26a6,6,0,0,1,6,6v4a6,6,0,0,1-6,6H6a6,6,0,0,1-6-6V6A6,6,0,0,1,6,0Z"
                        transform="translate(647 288)" fill="#fff" />
                    <path d="M4,0H76a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z"
                        transform="translate(623 601)" fill="#fff" />
                    <path d="M4,0H76a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z"
                        transform="translate(750 273)" fill="#f2f2f2" />
                    <rect class="color_var" width="160" height="88" rx="8" transform="translate(750 311)" fill="#FFAF00" />
                    <rect width="80" height="16" rx="8" transform="translate(623 320)" fill="#fff" />
                    <rect width="528" height="66" rx="16" transform="translate(750 567)" fill="#f2f2f2" />
                    <path class="color_var" d="M4,0H76a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z"
                        transform="translate(1198 273)" fill="#FFAF00" />
                    <rect width="80" height="16" rx="8" transform="translate(623 344)" fill="#fff" opacity="0.149" />
                    <rect width="80" height="16" rx="8" transform="translate(623 368)" fill="#fff" opacity="0.149" />
                    <rect width="80" height="16" rx="8" transform="translate(623 392)" fill="#fff" opacity="0.149" />
                    <rect width="80" height="16" rx="8" transform="translate(623 416)" fill="#fff" opacity="0.149" />
                    <rect class="color_var" width="160" height="88" rx="8" transform="translate(1118 311)" fill="#FFAF00" />
                    <rect class="color_var" width="160" height="88" rx="8" transform="translate(934 311)" fill="#FFAF00" />
                    <rect width="528" height="66" rx="16" transform="translate(750 489)" fill="#f2f2f2" />
                    <rect width="528" height="66" rx="16" transform="translate(750 411)" fill="#f2f2f2" />
                </g>
            </svg>
        </div>
    </div>


</div>

<script>
    // معاينة الشعار
    const logoInput = document.getElementById('restaurant_logo');
    const logoPreview = document.getElementById('logoPreview');
    logoInput.addEventListener('change', (e) => {
        const file = e.target.files?.[0];
        if (!file) { logoPreview.src = ''; return; }
        const reader = new FileReader();
        reader.onload = () => { logoPreview.src = reader.result; };
        reader.readAsDataURL(file);
    });

    // Primary color sync
    const primaryPicker = document.getElementById('primary_color_picker');
    const primaryText = document.getElementById('primary_color_text');

    primaryPicker.addEventListener('input', () => {
        primaryText.value = primaryPicker.value
        updateSVGColor(primaryPicker.value);
    });
    primaryText.addEventListener('input', () => {
        if (/^#([0-9A-Fa-f]{3}){1,2}$/.test(primaryText.value)) {
            primaryPicker.value = primaryText.value;
            console.log(primaryPicker.value)
        }
    });

    // Secondary color sync
    const secondaryPicker = document.getElementById('secondary_color_picker');
    const secondaryText = document.getElementById('secondary_color_text');

    secondaryPicker.addEventListener('input', () => secondaryText.value = secondaryPicker.value);
    secondaryText.addEventListener('input', () => {
        if (/^#([0-9A-Fa-f]{3}){1,2}$/.test(secondaryText.value)) {
            secondaryPicker.value = secondaryText.value;
        }
    });

    // العنصر SVG
    const svg = document.getElementById('restaurantSVG');

    // دالة لتحديث اللون
    function updateSVGColor(newColor) {
        const elements = svg.querySelectorAll(".color_var");
        elements.forEach(el => el.setAttribute('fill', newColor));
    }

    // تهيئة اللون الافتراضي عند تحميل الصفحة
    updateSVGColor(primaryPicker.value);

</script>

{% endblock content %}